<!DOCTYPE HTML>
<html>
<head>
	<title>PinnerSpace Home</title>
	<link rel="stylesheet" href="../bootstrap/css/bootstrap.min.css">
	<link rel="stylesheet" href="../bootstrap/css/bootstrap-theme.min.css">
	<script src="../scripts/jquery-1.11.1.min.js" type="text/javascript"></script>
	<script src="../bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
	<script src="../scripts/fabric.js" type="text/javascript"></script>
	<script src="../scripts/jscolor/jscolor.js" type="text/javascript"></script>
	<script src="../scripts/jquery.tools.min.js" type="text/javascript"></script>
	<script src="../scripts/jquery-ui-1.10.4.custom.min.js" type="text/javascript"></script>
	<script src="../scripts/tinycolor.js" type="text/javascript"></script>
	<!--Canvas Script--> <!--Maybe should move to another file? When it's more or less done?-->
	<script type = "text/javascript">
	if (window.location.href.indexOf('#_=_') > 0) {
    	window.location = window.location.href.replace(/#.*/, '');
	}

	window.onbeforeunload = function(e){
		if(!isSaved){
			return "Warning! Your board does NOT auto-save.\nAny unsaved changes will be lost (forever)!";
		}
	};

	var canvas;
	var bgcolor = '#FFFFFF';	// Colour setter for background
	var blkcolor = '#ffffff',	// Colour setter for new block
		blkcolor2 = '#ffffff';	// Colour setter for current block
	var orig;					// Holds last selected/modified object (for clone)
	var atLimit;				// Holds last acceptable position
	var lastSave;				// Holds last save state (for load/revert)
	var isSaved;				// Counter for whether changes have been made
	function init(boardData){
		// Initialise imagebox for addImage()
		$("#imagebox").overlay({
			mask: {
				color: '#fff',
				loadSpeed: 200,
				opacity: 0.5
			},
			closeOnClick: false,
		});
		// Initialise Canvas
		canvas = new fabric.Canvas('canvas');
		canvas.on({
			'object:modified': checkOOB,
			'object:selected': objSelected,
			'object:scaling': setLimit,
			'object:rotating': setLimit,
		});
		// Store and Load canvas data
		lastSave = JSON.stringify(boardData); // console.log(boardData); // boardData is an object (boardData.object); loadFromJSON works with string
		loadCanvas();
		// If empty give some advice
		if(boardData.objects.length==0){
			var input = document.getElementById("addblock");
			alert("It appears your board is empty.\nPerhaps you would like to start by adding a block?");
			input.focus();
		}

   		$("#bgimgbox").overlay({ // may be better to remake a new init function that calls loadcanvas
			mask: {
				color: '#fff',
				loadSpeed: 200,
   				opacity: 0.5
    		},
    		closeOnClick: false,
   		});
   		$( "#selectableBG").selectable();
	}

	function loadCanvas(){
		// Load from lastSave, rerender canvas ('callback'), re-set default settings on all objects e.g. border (optional 'reviver')
		canvas.loadFromJSON(lastSave,canvas.renderAll.bind(canvas),function(o,object){ setDefSettings(object); });
		isSaved = true;
	}
	function setDefSettings(curr){
		curr.set({
			borderColor: 'rgba(67,46,79,0.75)',
			cornerColor: 'rgba(58,174,175,0.85)',
			cornerSize: 9,
			transparentCorners: false,
		});
		if(curr.height>curr.width)
			curr.set({minScaleLimit: 20.0/curr.height});
		else
			curr.set({minScaleLimit: 20.0/curr.width});
	}
	function saveCanvas(){
		$.post("/saveBoard", {
			boardUser: "{{ currBoard.boardUser }}",
			boardID: {{ currBoard.boardID }},
			data: JSON.stringify(canvas)
		});
		lastSave = JSON.stringify(canvas);
		alert("Successfully saved!");
		isSaved = true;
	}
	function revert(){
		var resp=confirm("You sure? All your unsaved work will be lost...");
		if(resp==true){
  			loadCanvas();
  		}
  	}
  	function clearCanvas(){
  		var resp=confirm("Are you sure? This will clear everything!");
  		if (resp){
  			canvas.clear();
  			isSaved = false;
  		}
  	}
  	function addBlock(){
  		var center = canvas.getCenter();
  		var rect = new fabric.Rect({
  			width: 10,
  			height: 10,
  			scaleX: 3,
  			scaleY: 3,
			fill: blkcolor,
		});
		setDefSettings(rect);		// Consider add(rect) to do setDef, .add(), center()/setCoords, setActive, isSaved
  		canvas.add(rect);
  		rect.center();
  		rect.setCoords();
  		canvas.setActiveObject(rect);
  		isSaved = false;
  	}
  	function cloneActive(){
  		var curr = canvas.getActiveObject();
  		var currGrp = canvas.getActiveGroup();
  		if(curr){
  			var clone = fabric.util.object.clone(curr);
  			canvas.add(clone);
  			clone.center();
  			clone.setCoords();
  			canvas.setActiveObject(clone);
  		}else if(currGrp){ // CONSIDER trying createGroup and breakGroup to allow control over groups
  			/*var newGroup = new fabric.Group();
  			for(var i=0; i<currGrp.objects.length; i++){
  				console.log(currGrp.objects[i]);
  				var clone = fabric.util.object.clone(currGrp.objects[i]);
  				newGroup.addWithUpdate(clone);
  			}
  			canvas.add(newGroup);
  			newGroup.destroy();*/
  			/*console.log(currGrp.objects);
  			var clone = fabric.util.object.clone(currGrp);
  			canvas.add(clone);
  			clone.saveState();
  			clone.destroy();
  			canvas.discardActiveGroup();
  			canvas.setActiveGroup(clone);*/
  		}else{
  			return;
  		}
  		isSaved = false;
  	}
  	function delActive() {
  		var currGrp = canvas.getActiveGroup();
  		var curr = canvas.getActiveObject();
		if(currGrp){
			currGrp.forEachObject(function(o){ canvas.remove(o) });
			canvas.discardActiveGroup().renderAll();
		} else if(curr){
			canvas.remove(canvas.getActiveObject());
		}
		resetInfoWin();
		isSaved = false;
  	}
	function setBG() {
		canvas.setBackgroundColor(bgcolor, canvas.renderAll.bind(canvas));
		isSaved = false;
	}
	function setBlkColor() {
		canvas.getActiveObject().setFill(blkcolor2);
		canvas.renderAll();
		isSaved = false;
	}

  	// text [ WIP ]
  	function addText() {
  		var input = document.getElementById("newtext");
  		var text = input.value;
  		if(text == null || text.trim() == ""){
  			alert('Please enter something!');
			input.focus(); // focuses on the blank to fill
			return;
		}
		var newText = new fabric.IText(text);
		canvas.add(newText);
		setDefSettings(newText);
		newText.center();
		newText.setCoords();
		canvas.setActiveObject(newText);
		isSaved = false;
  	}

  	function addPostIt(){
  		var colour = blkcolor;
  		var input = document.getElementById("newtext");
  		var text = input.value;
  		if(text == null || text.trim() == ""){
  			alert('Please enter something!');
			input.focus(); // focuses on the blank to fill
			return;
		}
		var textObj = new fabric.Text(text);
		var rect = new fabric.Rect({
			fill: blkcolor,
  			width: textObj.width,
  			height: textObj.height,
  			scaleX: textObj.scaleX + 0.1,
  			scaleY: textObj.scaleY + 0.1,
		})
		var postIt = new fabric.Group([rect,textObj]);
		canvas.add(postIt);
		setDefSettings(postIt);
		postIt.center();
		postIt.setCoords();
		canvas.setActiveObject(postIt);
		isSaved=false;
  	}

  	function addPostIt2(){
  		//Creates 2 rect, 1 for the top and 1 for the mainbody
  		//Should the height for the top be fixed??? i think so.. even when scaling.. but whatever.
  		//The top will have a darker color, use tinycolor to pick the darker shade? (possible)
  		//Insert both rect and group together to produce the postit.
  		var colour = blkcolor;
  		var color = tinycolor(colour);
  		
  		var input = document.getElementById("newtext");
  		var text = input.value;
  		/*if(text == null || text.trim() == ""){
  			alert('Please enter something!');
			input.focus(); // focuses on the blank to fill
			return;
		}*/
		var textObj = new fabric.Text(text);
		var rectBody = new fabric.Rect({
			fill: colour, //lighter
  			width: 150,
  			height: 100,
		})
		var rectTop = new fabric.Rect({
			fill: tinycolor.darken(color, 20).toHexString(), //Darker
  			width: 150,
  			height: 20,
		})

		var postIt = new fabric.Group([rectBody,rectTop]);
		postIt.postIt = true;
		canvas.add(postIt);
		setDefSettings(postIt);
		postIt.center();
		postIt.setCoords();
		postIt.item(1).setScaleY(1);
		postIt.item(1).height = 10;
		canvas.setActiveObject(postIt);
		isSaved=false;
  	}

  	// Code for changing to info tab on select
	function switchTab(){
		$("#myTab > .active").removeClass("active");
		$("#myTabContent > .active").removeClass("active");
		$("#currObjTab").addClass("active");
		$("#modifycurrent").addClass("in active");
	}
	function updateInfoWin(curr){
		var infoX = document.getElementById("infoX");
		var infoY = document.getElementById("infoY");
		var infoW = document.getElementById("infoW");
		var infoH = document.getElementById("infoH");
		var infoAng = document.getElementById("infoAng");
		infoX.value = curr.getLeft();
		infoY.value = curr.getTop();
		infoW.value = curr.getWidth();
		infoH.value = curr.getHeight();
		infoAng.value = curr.getAngle() % 360;
	}
	function resetInfoWin(){
		document.getElementById("infoX").value="";
		document.getElementById("infoY").value="";
		document.getElementById("infoW").value="";
		document.getElementById("infoH").value="";
		document.getElementById("infoAng").value="";
	}

	/*** Code to set limit to boundaries ***/
	// Save original state for clone (on selection)
	// Triggers switchTab(), updates InfoWindow
	function objSelected(e) { 
		/*if(e.target.get('type')=="i-text") {
			canvas.getActiveObject().tooltip({ effect: 'slide'});
  		}*/
  		orig = fabric.util.object.clone(e.target);
  		switchTab();
  		updateInfoWin(orig);
  	}

  	// Save last acceptable state (on scale/rotate)
	function setLimit(e){
		var curr=e.target;
		curr.setCoords();
		if (curr.postIt) {
			curr.item(1).setScaleY(1);
			curr.item(1).height = 10;
		}
		var bounds = curr.getBoundingRect(),
			maxWidth = canvas.getWidth(),
			maxHeight = canvas.getHeight();
		var outOf = {
			top: bounds.top<0,
			left: bounds.left<0,
			bottom: bounds.top+bounds.height>maxHeight,
			right: bounds.left+bounds.width>maxWidth,
		};

		// if not out of bounds, save state
		// (the interval is not very fast, so this method is not so precise if you move fast)
		if(!((outOf.top || outOf.left) || (outOf.bottom || outOf.right))){
			atLimit = {
				top: curr.getTop(),
				left: curr.getLeft(),
				scaleX: curr.getScaleX(),
				scaleY: curr.getScaleY(),
				angle: curr.getAngle(),
			};
		}
	}
	// Check if out of bounds (on modified)
	function checkOOB(e){
		var curr = e.target;
		if(!curr) return;
		// if scale/angle has been modified, checkScaleAngle for OOB
		if(((orig.getScaleX() != curr.getScaleX()) || (orig.getScaleY() != curr.getScaleY())) || (orig.getAngle() != curr.getAngle()))
			checkScaleAngle(curr);
		// otherwise check position
		else
			checkPos(curr);
		// save new state into orig
		orig = fabric.util.object.clone(curr);
		updateInfoWin(orig);
		isSaved = false;
	}
	function checkScaleAngle(curr){
		var bounds = curr.getBoundingRect(),
			maxWidth = canvas.getWidth(),
			maxHeight = canvas.getHeight();
		var outOf = {
			top: bounds.top<0,
			left: bounds.left<0,
			bottom: bounds.top+bounds.height>maxHeight,
			right: bounds.left+bounds.width>maxWidth,
		};
		// if out of bounds, reset to last "atLimit" state
		if((outOf.top || outOf.left) || (outOf.bottom || outOf.right)){
			curr.set(atLimit);
			curr.setCoords();
			// console.log("New curr: " + JSON.stringify(curr));
		}
	}
	function checkPos(curr){
		var updateCoords = false,
		bounds = curr.getBoundingRect(),
		maxWidth = canvas.getWidth(),
		maxHeight = canvas.getHeight(),
		currAngle = curr.angle%360;
		var outOf = {
			top: bounds.top<0,
			left: bounds.left<0,
			bottom: bounds.top+bounds.height>maxHeight,
			right: bounds.left+bounds.width>maxWidth,
		};
		// Exceed Right
		if(outOf.right){
			updateCoords = true;
			if(currAngle>0 && currAngle<90){
				curr.set({left: maxWidth-Math.ceil(Math.cos(currAngle*Math.PI/180)*curr.width*curr.scaleX)});
			}else if(currAngle>=90 && currAngle<=180){
				curr.set({left: maxWidth});
			}else if(currAngle>180 && currAngle<270){
				curr.set({left: maxWidth-Math.ceil(Math.cos((270-currAngle)*Math.PI/180)*curr.height*curr.scaleY)});
			}else{
				curr.set({left: maxWidth-bounds.width});
			}
		}
		// Exceed Bottom
		if(outOf.bottom){
			updateCoords = true;
			if(currAngle>=0 && currAngle<=90){
				curr.set({top: maxHeight-bounds.height});
			}else if(currAngle>90 && currAngle<180){
				curr.set({top: maxHeight-Math.ceil(Math.cos((currAngle-90)*Math.PI/180)*curr.width*curr.scaleX)});
			}else if(currAngle>=180 && currAngle<=270){
				curr.set({top: maxHeight});
			}else{
				curr.set({top: maxHeight-Math.ceil(Math.cos((360-currAngle)*Math.PI/180)*curr.height*curr.scaleY)});
			}
		}
		// Exceed Left
		if(outOf.left){
			updateCoords = true;
			if(currAngle>0 && currAngle<90){
				curr.set({left: Math.ceil(Math.cos((90-currAngle)*Math.PI/180)*curr.height*curr.scaleY)});
			}else if(currAngle>=90 && currAngle<=180){
				curr.set({left: bounds.width});
			}else if(currAngle>180 && currAngle<270){
				curr.set({left: Math.ceil(Math.cos((currAngle-180)*Math.PI/180)*curr.width*curr.scaleX)});
			}else{
				curr.set({left: 0});
			}
		}
		// Exceed Top
		if(outOf.top){
			updateCoords = true;
			if(currAngle>=0 && currAngle<90){
				curr.set({top: 0});
			}else if(currAngle>=90 && currAngle<180){
				curr.set({top: Math.ceil(Math.cos((180-currAngle)*Math.PI/180)*curr.height*curr.scaleY)});
			}else if(currAngle>=180 && currAngle<270){
				curr.set({top: bounds.height});
			}else{
				curr.set({top: Math.ceil( Math.cos( (currAngle-270) * Math.PI/180) * curr.width * curr.scaleX )});
			}
		}

		// Implement new coordinates
		if(updateCoords){
			curr.setCoords();
		}
	}

	/*** Upload Image ***/
	function imageBox(e) {
		$("#imagebox").overlay().load();
	}

	function bgimgBox(e) {
		$("#bgimgbox").overlay().load();
	}

	function preloadImage() {
		var url = document.getElementById("imageurl").value;
		var image = document.getElementById("imageHolder");
		// image.crossOrigin = 'anonymous';
       	image.src = url;
       	$("#noPreview").hide();
       	$("#imageHolder").show();
       	$("img").error(function(){
    		$(this).hide();
    		$("#noPreview").show();
    	});
	}

	function bgpreloadImage() {
		var url = document.getElementById("bgimageurl").value;
		var image = document.getElementById("bgimageHolder");
       	$("#bgimageHolder").show();
       	image.src = url;
       	$("#bgnoPreview").hide();
       	$("img").error(function(){
    		$(this).hide();
    		$("#bgnoPreview").show();
    	});
	}

	function addImage(){
		var url = document.getElementById("imageHolder").src;
		fabric.Image.fromURL(url, function(oImg){
			if(oImg.getHeight()>oImg.getWidth()){
				oImg.scale((canvas.getHeight()/oImg.getHeight())/2);
			}else{
				oImg.scale((canvas.getWidth()/oImg.getWidth())/2);
			}
			setDefSettings(oImg);
			canvas.add(oImg);
			oImg.center();
			oImg.setCoords();
			canvas.setActiveObject(oImg);
		}, {crossOrigin: 'anonymous'});
		$("#imagebox").overlay().close();
	}

	var bgselected;
	$(function () {
		$("#selectableBG").selectable({
               selected: function() {
                  $(".ui-selected", this).each(function() {
                     bgselected = $("#selectableBG li").index(this) + 1;
                  });
               }
   		});
	});

    function changeBGImg() {
    	if (bgselected < 6) {
	    	canvas.setBackgroundImage('../images/bg' + bgselected + '.jpg', canvas.renderAll.bind(canvas));
    	} else {
    		canvas.backgroundImage = false;
    		canvas.renderAll();
    	}
    	isSaved = false;
    }
	</script>
	<style>
	table.center {
    	margin-left:auto; 
    	margin-right:auto;
  	}
  	table td { 
  		display: table-cell;
  		vertical-align: top; 
	}
	#imagebox, #bgimgbox {
    	display:none;
    	width:800px;
    	border:8px solid #666;
    	/* for modern browsers use semi-transparent color on the border. nice! */
    	border:8px solid rgba(82, 82, 82, 0.698);
    	/* hot CSS3 features for mozilla and webkit-based browsers (rounded borders) */
    	-moz-border-radius:5px;
   		-webkit-border-radius:5px;
	}

  	#imagebox div, #bgimgbox div {
    	border:1px solid #3B5998;
    	background-color:#fff;
  	}
  	#noPreview {
  		display:none;
  	}

  	#bgimageurl {
  		display:none;
  	}
  	#selectableBG .ui-selecting { background: #FECA40; }
 	#selectableBG .ui-selected { background: #F39814; color: white; }
 	#selectableBG { padding-left: 80px; width: 800px; list-style-type: none;}
  	#selectableBG li { padding: 1px; width: 200px; height: 140px; line-height: 135px; text-align: center; display: inline-block; vertical-align: middle;}

  	#infotable td {
  		padding:2px;
  		border-spacing:5px;
  	}
	</style>
	<!--End of Canvas Script-->
</head>
<body onload="init({{boardData}})">
	<!--HEADER-->
	<div id="header">
		<div class="jumbotron">
			<h2 class="title" style="text-align: center">PinnerSpace</h2>
			
			<ul class="nav nav-pills pull-left clearfix">
				<li><a href="./">Home</a></li>
				<li><a href="./boards">Boards</a></li>
				<li><a href="./settings">Settings</a></li>
			</ul>
			<ul class="nav nav-pills pull-right"> <!--class="span4 offset8 signin-align"-->
				<li class="disabled"><a>Welcome back <b>{{ user_nick }}</b>!</a></li>
				<li><a href="/logout">Logout</a></li>
			</ul>
		</div>
	</div>
	
	<!--BODY-->
	<table class="center">
		<tr>
			<!--LEFT: Pinboard-->
			<td>
				<div id="pinboard" style="width: 900px; height:600px; margin: 0 auto;">
					<!--canvas id must be consistent with js script-->
					<canvas id="canvas" width="900" height="600" style="border: 1px solid black;">
						This text is displayed if your browser does not support HTML5 Canvas.
					</canvas>
				</div>
			</td>

			<!--RIGHT: Info++ -->
			<td style="padding:10px">
				<!--BOARD NAME/SELECTOR-->
				<div id="boardInfo" align="left">
					You are currently viewing <strong>{{ currBoard.boardName }}</strong><br>
				</div>
				<span>Want to view another board? Click here -> </span>
				<div class="btn-group">
					<button class="disabled btn btn-primary">{{ currBoard.boardName }}</button>
					{% if user.numBoards > 0 or user.following > 0 %}
					<button data-toggle="dropdown" class="btn btn-primary dropdown-toggle"><span class="caret"></span></button>
					<ul class="dropdown-menu">
						{% for board in boards %}
						{% if board.boardID != currBoard.boardID or board.boardUser != currBoard.boardUser %}
						<li><a href="./board?boardID={{ board.boardID }}&boardUser={{ board.boardUser }}">{{ board.boardName }}</a></li>
						{% endif %}
						{% endfor %}
						<li class="divider"></li>
						{% for board2 in boards2 %}
						{% if board2.boardID != currBoard.boardID or board2.boardUser != currBoard.boardUser %}
						<li><a href="./board?boardID={{ board2.boardID }}&boardUser={{ board2.boardUser }}">{{ board2.boardName }}</a></li>
						{% endif %}
						{% endfor %}
					</ul>
					{% endif %}
				</div>
				
				<!--BREAK--><hr>

				<!--TO BE FILLED-->
				{% if user.email in currBoard.boardEditor %}
				<!--Show set of buttons exclusive to board editors-->
				{% elif user.email in currBoard.boardPoster %}
				<!--Show set of buttons exclusive to board posters-->
				{% else %}
				<!--Show set of buttons exclusive to board viewers-->
				{% endif %}

				<!--TABSS-->
				<ul id="myTab" class="nav nav-pills">
					<li class="active"><a href="#new" data-toggle="tab">New Object</a></li>
					<li id="currObjTab"><a href="#modifycurrent" data-toggle="tab">Current Object</a></li>
					<li><a href="#modifycanvas" data-toggle="tab">Modify Canvas</a></li>
				</ul>
				<hr>
				<div id="myTabContent" class="tab-content">
					<div class="tab-pane fade in active" id="new">
						<p>
						Add a Block:
						<input class="color {pickerFaceColor:'#DBDBDB'}" value="ffffff" onchange="blkcolor='#'+this.color.toString().toUpperCase()" id="addblock">
						<input type="submit" value="New Block" onclick="addBlock()">
						</p>
						<p>
						Add Text:
						<input type="text" id="newtext" placeholder="<insert text>">
						<button onclick="addText()">Add it!</button>
						</p>
						<p class="postitbutton">
							<button onclick="addPostIt()">New Post-It</button>
						</p>
						<p class="postitbutton2">
							<button onclick="addPostIt2()">New Post-It2</button>
						</p>
						<p class="imagebutton">
							<button onclick="imageBox()">Add Image</button>
						</p>
						<div id="imagebox" style="position: fixed;">
							<div>
								<p class="close">x</p>
								<h2>Insert Picture</h2>
								<input type="text" id="imageurl" onblur="preloadImage()" placeholder="<Image Url>">
								<button onclick="addImage()">Add it!</button>
								<hr>
								<center><p id="noPreview">No preview available</p>
								<img id="imageHolder" src=""></img></center>
							</div>
						</div>
					</div>

					<div class="tab-pane fade" id="modifycurrent">
						<table id="infotable">
							<tr>
								<td> Height: </td><td> <input type="text" id="infoH" style="width:50px;" maxlength="4"> </td>
								<td> Width: </td><td> <input type="text" id="infoW" style="width:50px;" maxlength="4"> </td>
							</tr>
							<tr>
								<td> X: </td><td> <input type="text" id="infoX" style="width:50px;" maxlength="4"> </td>
								<td> Y: </td><td> <input type="text" id="infoY" style="width:50px;" maxlength="4"> </td>
							</tr>
							<tr>
								<td> Angle: </td><td> <input type="text" id="infoAng" style="width:50px;" maxlength="3"> </td>
							</tr>
						</table>
						<p>
						Fill:
						<input class="color {pickerFaceColor:'#DBDBDB'}" value="ffffff" onchange="blkcolor2='#'+this.color.toString().toUpperCase()">
						<input type="submit" value="Apply" onclick="setBlkColor()">
						</p>
						<p>
						<button class="btn" onclick="delActive()">Delete</button>
						<button class="btn" onclick="cloneActive()">Clone</button>
						</p>
					</div>

					<div class="tab-pane fade" id="modifycanvas">
					<p>
						Background colour:
						<input class="color {pickerFaceColor:'#DBDBDB'}" onchange="bgcolor='#'+this.color.toString().toUpperCase()">
						<input type="submit" value="Apply" onclick="setBG()">
						<p class="bgimgbutton">
							<button onclick="bgimgBox()">Background Image</button>
						</p>
						<div id="bgimgbox" style="position: fixed;">
							<div>
								<p class="close">x</p>
								<center><h2>Background</h2></center>
								<ul id="selectableBG">
									<li class="ui-state-default"><img height="120" width="180" src="../images/bg1.jpg"></img></li>
									<li class="ui-state-default"><img height="120" width="180" src="../images/bg2.jpg"></img></li>
									<li class="ui-state-default"><img height="120" width="180" src="../images/bg3.jpg"></img></li>
									<li class="ui-state-default"><img height="120" width="180" src="../images/bg4.jpg"></img></li>
									<li class="ui-state-default"><img height="120" width="180" src="../images/bg5.jpg"></img></li>
									<li class="ui-state-default"><img height="120" width="180" id="bgimageHolder" src=""></img></li>
								</ul>
								<center>
								<p><input type="text" id="bgimageurl" onblur="bgpreloadImage()" placeholder="<Custom Image Url - 900 x 600>"></p>
								<button onclick="changeBGImg()">Change Background</button>
								<hr>
								</center>
							</div>
						</div>
					</p>
					</div>
				</div>
				<p>
					<button class="btn btn-success" onclick="saveCanvas()">Save Changes</button>
					<button class="btn btn-warning" onclick="revert()">Reset Changes</button>
					<button class="btn btn-danger" onclick="clearCanvas()">Clear Board</button>
				</p>
			</td>
			<!--END OF RIGHT COLUMN-->
		</tr>
	</table>
	<!--END BODY-->
</body>
</html>